
회원가입할 때 사용자가 적는 password 와 DB 에 저장되는 password 는 서로 다르다.
SpringSecurity에서 사용하는 `BCryptPassowrdEncoder`를 이용해서 password 를 어떻게 DB 에 저장하고 값을 비교하는 지 알아보자.

## 인코딩 과정

1. **비밀번호 입력** : 사용자가 "1234" 비밀번호를 입력한다.
2. **랜덤 문자열(salt) 생성** : 인코더는 내부적으로 랜덤한 문자열(salt)을 생성한다.
3. **비밀번호 + salt** : 비밀번호와 문자열을 합친다.
4. **salt 값 토대로 식별** : 비밀번호 안에 salt 값을 보고 같은 방식으로 해싱을 해서 같은 결과값이 나오면 같은 비밀번호로 간주하고 로그인한다.

#### 암호화된 문자열 구조
`$2a$10$N9qo8uLOickgx2ZMRZoMyeBj.ZnOPerian...
 `$2a$10` : 알고리즘  옵션      
 `N~B` : Salt(22자)
`뒷부분` : 실제 해시값`

## 비밀번호 비교

단순 문자열 비교(== or equals) 연산자를 사용하면 안된다.

`passwordEncoder.matches()`를 사용하여 DB 에 있는 값과 비교 검증한다.

1. 비밀번호 "1234" 입력
2. DB 에서 암호문(encodedPassword) 가져옴
3. `matches("1234",encodedPassword)`실행
4. 인코더는 암호문에서 salt 부분만 추출
5. 사용자가 입력한 "1234" 와 salt 를 붙여서 똑같이 암호화
6. 결과가 암호문의 뒷부분인 hash 부분과 같은지 확인