Nginx λ” μ›Ή μ„λ²„,ν”„λ΅μ‹ μ„λ²„ ,[[λ΅λ“ λ°Έλ°μ„]]λ“±μΌλ΅ λ„λ¦¬ μ‚¬μ©λλ‹¤.

μ°Έκ³ 
- [[μμ•½,κ²°μ  μ”μ²­ κ±΄μ— λ€ν• Nginx μ²λ¦¬]]

## π“ μ›Ή μ„λ²„
[Spring λ‚΄μ—μ„ client - server μ μ”μ²­ μ‘λ‹µ λ°©μ‹](../Spring%20κ°λ…/spring%20λ‚΄λ¶€/Spring%20λ‚΄μ—μ„%20client%20-%20server%20μ%20μ”μ²­%20μ‘λ‹µ%20λ°©μ‹.md)

## π“ ν”„λ΅μ‹ μ„λ²„
Nginx λ” 2κ°€μ§€ λ°©μ‹μ ν”„λ΅μ‹ μ„λ²„λ¥Ό κµ¬ν„ν•  μ μλ‹¤.

###  β… ν¬μ›λ“ ν”„λ΅μ‹ (Forward Proxy)

Forward Proxy λ” κ°™μ€ λ‚΄λ¶€λ§μ— μ΅΄μ¬ν•λ” ν΄λΌμ΄μ–ΈνΈμ μ”μ²­μ„ λ°›μ•„ μΈν„°λ„·μ„ ν†µν•΄ μ™Έλ¶€ μ„λ²„μ—μ„ λ°μ΄ν„°λ¥Ό κ°€μ Έμ™€ ν΄λΌμ΄μ–ΈνΈμ—κ² μ‘λ‹µν•΄μ¤€λ‹¤.

![μ‚¬μ§„](../images/nginx1.png)
μ¤‘λ³µλλ” μ—¬λ¬ μ”μ²­λ“¤μ— λ€ν• μ‘λ‹µμ„ ν”„λ΅μ‹ μ„λ²„μ— μΊμ‹±λ κ°’μ„ ν΄λΌμ΄μ–ΈνΈμ—κ² λ°”λ΅ μ‘λ‹µν•΄μ£Όμ–΄ ν›¨μ”¬ λΉ λ¥΄κ² κ°’μ„ μ „λ‹¬ν•  μ μκ³  μ„λ²„μ λ¶€ν•λ¥Ό μ¤„μΌ μ μλ‹¤.

### β… λ¦¬λ²„μ¤ ν”„λ΅μ‹ (Reverse Proxy)

Reverse Proxy λ” μ›Ήμ„λ²„ / WAS μ•μ— λ†“μ—¬ μλ” κ²ƒμ„ λ§ν•λ‹¤. 
ν΄λΌμ΄μ–ΈνΈλ” μ›Ή  μ„λΉ„μ¤μ— μ ‘κ·Όν•  λ• μ›Ή μ„λ²„μ— μ”μ²­ν•λ” κ²ƒμ΄ μ•„λ‹ ν”„λ΅μ‹λ΅ μ”μ²­ν•κ² λκ³ , ν”„λ΅μ‹ λ’¤μ—(reverse) μλ” μ„λ²„λ΅λ¶€ν„° λ°μ΄ν„°λ¥Ό κ°€μ Έμ¤λ” λ°©μ‹μ΄λ‹¤. 
μ΄λ ‡κ² ν΄λΌμ΄μ–ΈνΈμ—κ² μ„λ²„μ μ •λ³΄λ¥Ό κ°μ¶ μ μλ‹¤.

![μ‚¬μ§„](../images/nginx2.png)

μ΄λ ‡κ² Nginxμ λ¦¬λ²„μ¤ ν”„λ΅μ‹ κΈ°λ¥μ„ μ‚¬μ©ν•λ©΄ Web Server(Nginx)κ°€ μ •μ  μ»¨ν…μΈ λ¥Ό λ°”λ΅ μ²λ¦¬ν•κ³ , WAS λ” λ™μ  μ»¨ν…μΈ  μ”μ²­λ§ μ²λ¦¬ν•  μ μλ‹¤. μ¦‰, WAS μ λ¶€λ‹΄μ„ μ¤„μ—¬ μ„λ²„ μμ›μ„ ν¨μ¨μ μΌλ΅ μ‚¬μ©ν•  μ μλ‹¤.


### β… HTTPS λ³΄μ• μΈμ¦

1. **μ—°κ²° μλ¦½ λ° ν•Έλ“μ…°μ΄ν¬ (TLS Handshake)**
- ν΄λΌμ΄μ–ΈνΈκ°€ 80 ν¬νΈλ΅ μ”μ²­μ„ ν–μ„ λ• Nginx λ” 443 ν¬νΈ μ ‘μ†μΌλ΅ μ°νν•λ‹¤.
- μ•„λ κ³Όμ •μ€ 443ν¬νΈλ΅ μ ‘μ†μ„ μ‹λ„ν–μ„ λ• μΌμ–΄λ‚λ” κ³Όμ •μ΄λ‹¤.
	a. **TCP Connection** : ν΄λΌμ΄μ–ΈνΈμ™€ Nginx μ‚¬μ΄μ— 3-way handshake 
	b. **TLS Handshake** : TCP μ—°κ²° μ„μ—μ„ λ³΄μ• μ •μ±… λ™μ‘
	- Nginx -> Client : κ³µκ°ν‚¤λ¥Ό ν¬ν•¨ν• μΈμ¦μ„ μ „μ†΅
	- Nginx <-> Client : λ€μΉ­ν‚¤ μƒμ„±ν•μ—¬ κ³µμ 

2. **SSL Termination** 
- μ•”νΈν™”λ νΈλν”½μ μΆ…μ°©μ§€ κ²°μ •
	a. **ν΄λΌμ΄μ–ΈνΈ -> Nginx** : ν΄λΌμ΄μ–ΈνΈκ°€ λ³΄λ‚Έ λ°μ΄ν„°(HTTP ν¨ν‚·)λ” μ•”νΈν™”λμ–΄ μ „μ†΅
	b. **Nginx λ³µνΈν™”** : Nginx λ” μ•”νΈν™”λ ν¨ν‚·μ„ λ°›μ•„μ„ λ³µνΈν™”
	- μ•”νΈν™”λ HTTPS ν¨ν‚· -> ν‰λ¬ΈμΈ HTTP ν¨ν‚·μΌλ΅ λ³€ν™

2. **Reverse Proxy** 
- λ³µνΈν™”λ HTTP μ”μ²­μ„ docker network λ¥Ό ν†µν•΄ Spring μ„λ²„λ΅ μ „λ‹¬
- Nginx <-> Spring Server : μƒλ΅μ΄ TCP μ—°κ²°, HTTP ν”„λ΅ν† μ½μ„ μ‚¬μ©ν•μ—¬ ν‰λ¬ΈμΌλ΅ ν†µμ‹ 
